<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->

<!DOCTYPE html>
<html>
<head>
<title>E Shop Cart Widget A Flat Responsive Widget Template :: W3layouts</title>

<!-- For-Mobile-Apps -->
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content="E Shop Cart Widget Responsive, Login Form Web Template, Flat Pricing Tables, Flat Drop-Downs, Sign-Up Web Templates, Flat Web Templates, Login Sign-up Responsive Web Template, Smartphone Compatible Web Template, Android Compatible Web Template, Free Web Designs for Nokia, Samsung, LG, Sony Ericsson, Motorola Web Design" />
	<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- //For-Mobile-Apps -->

<!-- Custom-Theme-Files -->
	<link rel="stylesheet" href="../css/style_cart.css" type="text/css" media="all" />
<!-- //Custom-Theme-Files -->

<!-- Remove-Item-JavaScript -->

	<script type="text/javascript" src="../js/jquery-1.11.1.min.js"></script>
	<script>
		var uphone = document.cookie;
		var getUserUrl = "/users/p/" + uphone;
		$.get(getUserUrl, function (data, status) {
			var uid = data.id;
			var getCartUrl = "/carts/" + uid;
			var totalPrice = 0;
			$.get(getCartUrl, function (data, status) {
				for(var i in data) {
					var commodityUrl = "/commodities/" + data[i].cid;
					$.get(commodityUrl, function (data, status) {
						totalPrice += data.cprice;
						$(".items").append(
								$(`<div class='item1'></div>`).append(
										$(`<div class='close1' </div>`).append(
												$(`<div class='alert-close2' name="/carts/${data.id}/${uid}"></div>`),
												$(`<div class="image1"></div>`).append(
														$(`<img src=${data.cpicture} alt="item1">`)
												),
												$(`<div class="title1"></div>`).append(
														$(`<p></p>`).text(data.cname)
												),
												$(`<div class="quantity1"></div>`).append(
														$(`<input type="number" name="quantity" min="1" max="10" value="1">`)
												),
												$(`<div class="price1"></div>`).append(
														$(`<p></p>`).text(data.cprice.toFixed(2))
												),
												$(`<div class="clear"></div>`)
										)
								)
						);
					}).done(function () {
						$(".total2").text(totalPrice.toFixed(2));
					})
				}
			}
			)
		})
		
	</script>
	<script>
		$(document).ready(function () {
			$(".items").on("click", "div div .alert-close2",function () {
				$(this).parent().parent().remove();
				var str = $(this).attr("name");
				$.ajax({
					type: "DELETE",
					url: str,
					success: function () {
					}
				})
			})
		})
	</script>

<!--	<script>$(document).ready(function(c) {-->
<!--		$('.alert-close1').on('click', function(c){-->
<!--			$('.close1').fadeOut('slow', function(c){-->
<!--		  		$('.close1').remove();-->
<!--			});-->
<!--		});-->
<!--	});-->
<!--	</script>-->
<!--	<script>$(document).ready(function(c) {-->
<!--		$('.alert-close2').on('click', function(c){-->
<!--			$('.close2').fadeOut('slow', function(c){-->
<!--		  		$('.close2').remove();-->
<!--			});-->
<!--		});-->
<!--	});-->
<!--	</script>-->
<!--	<script>$(document).ready(function(c) {-->
<!--		$('.alert-close3').on('click', function(c){-->
<!--			$('.close3').fadeOut('slow', function(c){-->
<!--		  		$('.close3').remove();-->
<!--			});-->
<!--		});-->
<!--	});-->
<!--	</script>-->
<!-- //Remove-Item-JavaScript -->

</head>

<!-- Body-Starts-Here -->
<body>

	<h1>购物车</h1>

	<!-- Content-Starts-Here -->
	<div class="container">

		<!-- Mainbar-Starts-Here -->
		<div class="main-bar">
			<div class="product">
				<h3>商品</h3>
			</div>
			<div class="quantity">
				<h3>数量</h3>
			</div>
			<div class="price">
				<h3>单价</h3>
			</div>
			<div class="clear"></div>
		</div>
		<!-- //Mainbar-Ends-Here -->

		<!-- Items-Starts-Here -->
		<div class="items">
		</div>
		<!-- //Items-Ends-Here -->

		<!-- Total-Price-Starts-Here -->
		<div class="total">
			<div class="total1">总价</div>
			<div class="total2">0</div>
			<div class="clear"></div>
		</div>
		<!-- //Total-Price-Ends-Here -->

		<!-- Checkout-Starts-Here -->
		<div class="checkout">
			<div class="checkout-btn">
				<a href="#">结算</a>
			</div>
			<div class="return">
				<a href="index.html">返回商城</a>
			</div>
			<div class="clear"></div>
		</div>
		<!-- //Checkout-Ends-Here -->

	</div>
	<!-- Content-Ends-Here -->

	<!-- Copyright-Starts-Here -->
	<div class="copyright">
	    <p>&copy; 2022 | CR ZZR WHY </a></p>
	</div>
	<!-- //Copyright-Ends-Here -->

</body>
<!-- Body-Ends-Here -->

</html>